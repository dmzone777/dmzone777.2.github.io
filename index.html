<!DOCTYPE html>
<html>
<head>
<title>Ultra Smooth SlowMo Master</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
margin:0;
font-family:Arial;
background:linear-gradient(135deg,#667eea,#764ba2);
display:flex;
justify-content:center;
align-items:center;
height:100vh;
}

.card{
background:white;
padding:20px;
border-radius:15px;
width:360px;
box-shadow:0 10px 25px rgba(0,0,0,0.2);
text-align:center;
}

video{
width:100%;
border-radius:10px;
margin-top:10px;
}

button,input{
width:100%;
padding:10px;
margin-top:10px;
border-radius:8px;
border:1px solid #ddd;
}

button{
background:#667eea;
color:white;
border:none;
font-weight:bold;
cursor:pointer;
}
</style>
</head>

<body>

<div class="card">
<h2>Ultra Smooth SlowMo ðŸŽ¬</h2>

<input type="file" id="videoInput" accept="video/*">
<video id="video" controls loop></video>

<label>Speed</label>
<input type="range" id="speed" min="0.25" max="1" step="0.25" value="0.5">

<button onclick="setSpeed(0.25)">0.25x</button>
<button onclick="setSpeed(0.5)">0.5x</button>
<button onclick="setSpeed(0.75)">0.75x</button>

<label>Trim Start</label>
<input type="range" id="start" min="0" max="100" value="0">

<label>Trim End</label>
<input type="range" id="end" min="0" max="100" value="100">

<button onclick="exportSlow()">Export MP4</button>
</div>

<script>
const video=document.getElementById("video");
const input=document.getElementById("videoInput");
const speed=document.getElementById("speed");
const start=document.getElementById("start");
const end=document.getElementById("end");

input.onchange=e=>{
video.src=URL.createObjectURL(e.target.files[0]);
}

speed.oninput=()=> video.playbackRate=speed.value;

function setSpeed(v){
video.playbackRate=v;
speed.value=v;
}

// trim preview
video.addEventListener("timeupdate",()=>{
if(video.duration){
const endTime=(end.value/100)*video.duration;
if(video.currentTime>=endTime) video.pause();
}
});

async function exportSlow(){
const canvas=document.createElement("canvas");
const ctx=canvas.getContext("2d");

canvas.width=video.videoWidth;
canvas.height=video.videoHeight;

const stream=canvas.captureStream(90);
const recorder=new MediaRecorder(stream);
let chunks=[];

recorder.ondataavailable=e=>chunks.push(e.data);
recorder.onstop=e=>{
const blob=new Blob(chunks,{type:"video/webm"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="slowmo.mp4";
a.click();
}

recorder.start();

video.currentTime=(start.value/100)*video.duration;
video.playbackRate=speed.value*0.8;
video.play();

let lastFrame=null;

function draw(){
ctx.globalAlpha=0.35;
if(lastFrame) ctx.drawImage(lastFrame,0,0,canvas.width,canvas.height);

ctx.globalAlpha=0.85;
ctx.filter="blur(0.3px)";
ctx.drawImage(video,0,0,canvas.width,canvas.height);
ctx.filter="none";

lastFrame=document.createElement("canvas");
lastFrame.width=canvas.width;
lastFrame.height=canvas.height;
lastFrame.getContext("2d").drawImage(canvas,0,0);

ctx.globalAlpha=0.25;
ctx.drawImage(video,0,0,canvas.width,canvas.height);
ctx.globalAlpha=1;

const endTime=(end.value/100)*video.duration;

if(!video.paused && !video.ended && video.currentTime<endTime){
setTimeout(()=>requestAnimationFrame(draw),1000/90);
}else{
recorder.stop();
}
}
draw();
}
</script>

</body>
</html>